
# GuignoMap - SystÃ¨me de gestion pour la GuignolÃ©e 2025 ğŸ„

Une application web moderne conÃ§ue spÃ©cialement pour optimiser la collecte de dons lors de la GuignolÃ©e 2025 Ã  Mascouche.

## âœ¨ Nouvelles fonctionnalitÃ©s v4.1

### ğŸ‘” Interface Superviseur/Gestionnaire
- **Assignations par secteur** : SÃ©lection secteur + Ã©quipe et assignation en bloc
- **Compteur rues non assignÃ©es** : Vue en temps rÃ©el des rues sans Ã©quipe
- **Export CSV assignations** : Colonnes secteur, rue, Ã©quipe, statut
- **Gestion d'erreur gracieuse** : Masquage des fonctionnalitÃ©s indisponibles
- **Notifications toast** : Confirmations visuelles des actions

### ğŸ… Interface BÃ©nÃ©vole "Mes rues"
- **Vue filtrÃ©e par Ã©quipe** : Seulement les rues assignÃ©es Ã  l'Ã©quipe connectÃ©e
- **Boutons de statut** : "En cours" et "TerminÃ©e" avec mise Ã  jour immÃ©diate
- **Gestion des notes** : Ajout/affichage des notes par adresse spÃ©cifique
- **Statistiques d'Ã©quipe** : MÃ©triques de progression en temps rÃ©el
- **Journal d'activitÃ©** : Historique des actions de l'Ã©quipe

### ğŸ›¡ï¸ SÃ©curitÃ© et robustesse v4.1
- **Validation stricte** : RÃ©utilisation des validators pour toutes les entrÃ©es
- **Backup automatique** : DÃ©corateur auto_backup_before_critical sur toutes les Ã©critures
- **Logging complet** : Journal d'activitÃ© en base de donnÃ©es ET fichier texte
- **Gestion d'erreur** : DÃ©gradation gracieuse sans plantage de l'application

### ğŸ“Š Exports professionnels
- **Maintien des exports PDF/Excel** : Aucune modification des fonctionnalitÃ©s existantes
- **Nouveau CSV assignations** : Export spÃ©cialisÃ© pour la gestion des secteurs
- **Interface unifiÃ©e** : Tous les exports accessibles depuis l'onglet Export

## âœ¨ FonctionnalitÃ©s v4.0 (acquises)

### ğŸ”’ SÃ©curitÃ© renforcÃ©e
- **Migration bcrypt** : Remplacement SHA256 par bcrypt avec salage automatique
- **Migration automatique** des anciens mots de passe
- **Validation d'entrÃ©es** : Protection contre injection SQL et XSS
- **Sanitisation complÃ¨te** de toutes les donnÃ©es utilisateur

### ğŸ’¾ SystÃ¨me de backup automatique
- **Backup automatique** avant toutes opÃ©rations critiques
- **Format ZIP** avec horodatage
- **Rotation automatique** : conservation 7 jours
- **Interface de gestion** des backups avec tÃ©lÃ©chargement

## âœ¨ FonctionnalitÃ©s v3.0 (acquises)

### ğŸ„ Interface festive
- **Page d'accueil moderne** avec compte Ã  rebours vers NoÃ«l
- **En-tÃªte festif** aux couleurs de la GuignolÃ©e 2025
- **Carte de NoÃ«l thÃ©matique** avec icÃ´nes festives

### ğŸ“± Optimisations mobiles
- **Interface responsive** optimisÃ©e pour tous les appareils
- **Navigation tactile** adaptÃ©e aux smartphones
- **ContrÃ´les de carte** optimisÃ©s pour mobile

### ğŸ† SystÃ¨me de motivation
- **Badges d'Ã©quipe** : DÃ©butants, Actifs, Champions, LÃ©gendes
- **Notifications temps rÃ©el** pour les accomplissements
- **Tableaux de bord interactifs** avec graphiques Plotly

### ğŸ“Š Centre d'export avancÃ©
- **Export Excel professionnel** avec formatage automatique
- **GÃ©nÃ©ration de listes SMS** pour la communication d'Ã©quipe
- **Export PDF** (prÃ©paration)
- **Rapports dÃ©taillÃ©s** par Ã©quipe et secteur

### ğŸ—ºï¸ AmÃ©liorations cartographiques
- **Choix de fonds de carte** : OpenStreetMap France, CARTO Voyager, Esri
- **Zoom optimisÃ©** centrÃ© sur Mascouche
- **Zone d'affichage agrandie** : 90% de l'Ã©cran sur PC
- **Gestion d'erreur robuste** : secrets.toml optionnel
- **VisibilitÃ© amÃ©liorÃ©e** des rues avec lignes plus Ã©paisses
- **RÃ©cupÃ©ration complÃ¨te** de toutes les rues via OSM

### ğŸ—ºï¸ LÃ©gende de la carte (persistante)
- **4 Ã©tats visuels** :
  - ğŸŸ¢ **Vert** : Rues terminÃ©es (collecte finie)
  - ğŸŸ¡ **Jaune** : Rues en cours (Ã©quipe active)
  - ğŸ”´ **Rouge plein** : Rues assignÃ©es Ã  faire (Ã©quipe dÃ©signÃ©e)
  - ğŸ”´ **Rouge pointillÃ©** : Rues non assignÃ©es (aucune Ã©quipe)
- **Position fixe** : Bas-droite de la carte
- **Persistance garantie** : Reste visible au zoom/dÃ©zoom/dÃ©placement
- **Style moderne** : Fond blanc, bordure, ombre portÃ©e

### âš™ï¸ CompatibilitÃ© et modernisation
- **Python 3.13.6** et versions rÃ©centes de Streamlit
- **Suppression de use_container_width** (dÃ©prÃ©ciÃ©) âœ `width="stretch"`
- **Migration pandas Styler** : `applymap()` âœ `map()` avec helper de compatibilitÃ©
- **LÃ©gende persistante** via Folium Elements (remplace l'ancien HTML/CSS)
- **Chemins multi-plateformes** avec pathlib
- **Gestion des erreurs robuste** : l'application ne crash jamais
- **Code moderne** : Nettoyage des anciens hacks et workarounds

### ğŸ¨ Affichage des statuts
- **Codes internes** : `a_faire`, `en_cours`, `terminee` (base de donnÃ©es)
- **Affichage UI/exports** : "Ã€ faire", "En cours", "TerminÃ©e" (interface utilisateur)
- **Style visual** : Fond pastel + texte contrastÃ©, uniquement sur la colonne "Statut"
- **Couleurs harmonisÃ©es** : 
  - ğŸŸ¢ **TerminÃ©e** : Fond vert pÃ¢le (#E6F5EA)
  - ğŸŸ¡ **En cours** : Fond jaune pÃ¢le (#FFF3CC)  
  - ğŸ”´ **Ã€ faire** : Fond rose pÃ¢le (#FFE6EC)

### ğŸ”§ Interface assignations
- **SÃ©lecteur secteur** : Label clair "SECTEUR Ã€ ASSIGNER", aucun chevauchement
- **Tableau Ã©tat** : Colonnes Rue / Secteur / Ã‰quipe / Statut avec libellÃ©s franÃ§ais
- **Style uniforme** : Rendu standard avec thÃ¨me sombre (fond neutre, texte blanc)
- **Corrections UI** :
  - Fix superposition texte au-dessus du sÃ©lecteur 'SECTEUR Ã€ ASSIGNER' (suppression des sorties de debug/injections HTML), tableau des assignations sans stylisation spÃ©ciale (rendu uniforme)
  - Layout propre avec container/colonnes, sans overlay ni stylisation
  - Ã‰quipes : suppression du doublon de titre causant une superposition dans l'expander
  - Mot de passe Ã©quipes : minimum 4 caractÃ¨res, aucune autre contrainte

### ğŸ‘¥ Gestion moderne
- **Terminologie unifiÃ©e** : "gestionnaire" au lieu de "superviseur"
- **Navigation sidebar** moderne et intuitive
- **Interface bÃ©nÃ©vole restreinte** aux rues assignÃ©es seulement
- **Authentification simplifiÃ©e** avec cartes de connexion
- **Gestion des Ã©quipes amÃ©liorÃ©e** :
  - Ajout d'un champ Confirmer le mot de passe (crÃ©ation d'Ã©quipe)
  - Politique : minimum 4 caractÃ¨res, aucune autre contrainte
  - Option : case Afficher les mots de passe

## ğŸš€ Installation et utilisation

### PrÃ©requis
- Python 3.8+
- AccÃ¨s internet pour OSM et les tuiles de carte

### Installation